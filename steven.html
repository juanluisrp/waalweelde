<!doctype html>
<html lang="nl">
 <head>
  <meta charset="utf-8">
  <title>URD Delta Oost - dashboard</title>
  <!-- styles -->
  <link rel="stylesheet" type="text/css" href="http://extjs.cachefly.net/ext-3.4.0/resources/css/ext-all.css" />
  <link rel="stylesheet" type="text/css" href="http://extjs.cachefly.net/ext-3.4.0/resources/css/xtheme-gray.css" />
  <link rel="stylesheet" type="text/css" href="style/style.css" />
  <!-- ext -->
  <script src="http://extjs.cachefly.net/ext-3.4.0/adapter/ext/ext-base.js"></script>
  <script src="http://extjs.cachefly.net/ext-3.4.0/ext-all.js"></script>
  
  
        
  <!-- openlayers -->
  <link rel="stylesheet" type="text/css" href="./libs/openlayers/theme/default/style.css" />
	<script type="text/javascript" src="./libs/openlayers/OpenLayers.js"></script>

  <!-- geoext -->
  <link rel="stylesheet" type="text/css" href="./libs/geoext/resources/css/geoext-all.css" />
	<script type="text/javascript" src="./libs/geoext/lib/GeoExt.js"></script>

  <!-- gxp -->
	<link rel="stylesheet" type="text/css" href="./libs/gxp/src/theme/all.css" />
	<script type="text/javascript" src="./libs/gxp/src/script/loader.js"></script>
  
  <!-- local -->
  
  <script type="text/javascript">
  var app1, app2;
  var viewer;
//WMTS uses TILEMATRIXes instead of Z, so we need to have an array of all the needed IDs  
//For PDOK/BRT:
var matrixIds2 = new Array(26);
	    for (var i=0; i<26; ++i) {
	        matrixIds2[i] = 'EPSG:28992'+':' + i;
	    }        
//WMTS uses TILEMATRIXes instead of Z, so we need to have an array of all the needed IDs
//For PDOK/luchtfoto:
      var matrixIds3 = new Array(26);
	    for (var i=0; i<10; ++i) {
	        matrixIds3[i] = '0' + i;
	    }  for (var i=10; i<26; ++i) {
	        matrixIds3[i] = '' + i;
	    }
  Ext.onReady(function() {
var ltree = new Ext.Container({
  applyTo: 'layertree',
  id:"ltreec"
 
 })

 app2 = new gxp.Viewer({
    id:"viewer2",
    portalConfig: {id: "viewer2", xtype: "panel", split:true, width: "50%", region: "east", title: "kaart 2", collapsible: true,              collapseMode: "mini"},
    portalItems: ["map2"],
    mapItems: [
        {
            xtype: "gx_zoomslider",
            vertical: true,
            height: 100
        }
    ],
    sources: {
        brt: {
            ptype: "gxp_olsource"
        }
    },
    map: {
    
        id: "map2",
        region: "center",
         projection: "EPSG:28992",
        units: "m",
        resolutions: [3440.64, 1720.32, 860.16, 430.08, 215.04, 107.52, 53.76,
					26.88, 13.44, 6.72, 3.36, 1.68, 0.84, 0.42, 0.21],
        maxExtent: [-285401.92,22598.08,595401.9199999999,903401.9199999999],
        layers: [{
            source: "brt",
            type: "OpenLayers.Layer.WMTS",
            args: [{name: 'BRT Achtergrondkaart (WMTS)',
        url: 'http://geodata.nationaalgeoregister.nl/wmts/',
        layer: 'brtachtergrondkaart',
        style: null,
        matrixSet: "EPSG:28992",
        matrixIds:  matrixIds2,
        visibility: true,
        attribution: '(c) OSM & Kadaster',
        format: "image/png8"}]
        }],
        allOverlays: true
    },
    tools: [{
            
            outputTarget: 'ltreec',
            ptype: "gxp_layermanager",
            id: "lm2",
            outputConfig: {
                id: "tree2",
                title: "Kaartlagen kaart 2",
                tbar: []  // we will add buttons to "tree.bbar" later
            }
        }],
    listeners: {
        portalReady: createViewport
    }
    

});
 app1 = new gxp.Viewer({
    portalConfig: {id: "viewer1", xtype: "panel", region: "center"},
     portalItems: [{
              xtype: "panel",
              id: "header",
              region: "north",        
              height: 85
            },{
              xtype: "panel",
              id: "westPanel",
              title: "Informatie bronnen",
              region: "west",
              width: 200,
              split: true,
              collapseMode: "mini",
              items: [
              {
                xtype: "panel",
                id: "layertree1"
              },
              {
                xtype: "panel",
                id:"layertree2",
                contentEl:'layertree'
              }
              ]
            },{ 
              xtype: "panel",
              region: "center",
              layout: "border",

               
              
              items: [{
                xtype: "toolbar",
                region:"north",
                height:25
              },
              
              "map1","viewer2",
              {
                xtype: "panel",
                region:"south",
                split:true,
                height:25
              }]
            }],
    mapItems: [
        {
            xtype: "gx_zoomslider",
            vertical: true,
            height: 100
        }
    ],
    sources: {
        brt: {
            ptype: "gxp_olsource"
        },
        lucht: {
            ptype: "gxp_olsource"
        }
    },
    map: {
        title: 'kaart 1',
        split: true, 
        id: "map1",
        region: "center",
        projection: "EPSG:28992",
        units: "m",
        resolutions: [3440.64, 1720.32, 860.16, 430.08, 215.04, 107.52, 53.76,
					26.88, 13.44, 6.72, 3.36, 1.68, 0.84, 0.42, 0.21],
        maxExtent: [-285401.92,22598.08,595401.9199999999,903401.9199999999],
        layers: [{
            source: "brt" ,
            type: "OpenLayers.Layer.WMTS",
            args: [{name: 'BRT Achtergrondkaart (WMTS)',
        url: 'http://geodata.nationaalgeoregister.nl/wmts/',
        layer: 'brtachtergrondkaart',
        style: null,
        matrixSet: "EPSG:28992",
        matrixIds:  matrixIds2,
        visibility: true,
        attribution: '(c) OSM & Kadaster',
        format: "image/png8"}]           
        },{
          source: "lucht" ,
            type: "OpenLayers.Layer.WMTS",
            args: [{
        
        name: 'PDOK luchtfoto (WMTS)',
        url: 'http://geodata1.nationaalgeoregister.nl/luchtfoto/wmts?style=&',
        layer: 'luchtfoto',
        style: null,
        matrixSet: "nltilingschema",
        matrixIds:  matrixIds3,
        visibility: false,
        attribution: '(c) OSM & Kadaster',
        format: "image/jpeg"}]
        }]
    },
    tools: [{
            outputTarget: 'layertree1',
            ptype: "gxp_layermanager",
            id: "lm1",
            outputConfig: {
                id: "tree",
                title: "Kaartlagen kaart 1",
                tbar: []  // we will add buttons to "tree.bbar" later
            }
        }],
    listeners: {
        portalReady: createViewport
    }
});



var portalsReady = 0;

function createViewport() {
    portalsReady++;
    if (portalsReady == 2) {
        viewer = new Ext.Viewport({
            layout:'border',
            items: [ 
            
              
              "viewer1"
            
            ]
        });
    
    initialise();
    }
}  

});
  </script>
  <script type="text/javascript" src="./script/ol-link-gxp.js"></script>
 </head>
 <body>
  <div id="main"></div>
  <div id="layertree"></div>
 </body>
</html>