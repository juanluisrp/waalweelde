<!doctype html>
<html lang="nl">
 <head>
  <meta charset="utf-8">
  <title>URD Delta Oost - dashboard</title>
  <!-- styles -->
  <link rel="stylesheet" type="text/css" href="http://extjs.cachefly.net/ext-3.4.0/resources/css/ext-all.css" />
  <link rel="stylesheet" type="text/css" href="http://extjs.cachefly.net/ext-3.4.0/resources/css/xtheme-gray.css" />
  <link rel="stylesheet" type="text/css" href="http://extjs.cachefly.net/ext-3.4.0/style.css" />
  <!-- ext -->
  <script src="http://extjs.cachefly.net/ext-3.4.0/adapter/ext/ext-base.js"></script>
  <script src="http://extjs.cachefly.net/ext-3.4.0/ext-all.js"></script>
  
  <!-- openlayers -->
  <link rel="stylesheet" type="text/css" href="./libs/openlayers/theme/default/style.css" />
	<script type="text/javascript" src="./libs/openlayers/OpenLayers.js"></script>

  <!-- geoext -->
  <link rel="stylesheet" type="text/css" href="./libs/geoext/resources/css/geoext-all.css" />
	<script type="text/javascript" src="./libs/geoext/lib/GeoExt.js"></script>

  <!-- gxp -->
	<link rel="stylesheet" type="text/css" href="./libs/gxp/src/theme/all.css" />
	<script type="text/javascript" src="./libs/gxp/src/script/loader.js"></script>
  
  <!-- local -->
  
  <script type="text/javascript">
  
  
  var app;
Ext.onReady(function() {

app = new gxp.Viewer({
        proxy: "proxy.php?url=",
        portalConfig: {
            renderTo: document.body,
            layout: "border",
           width:"100%",height:800,
            border: false,
            items: [{
                xtype: "panel",
                region: "center",
                border: false,
                layout: "fit",
                items: ["map-viewport"]
            }, {
				id:"sidebar",
				layout: "fit",
                region: "west",
                width: 200,
				items: [
			{
                id: "tree-container",
                xtype: "container"
                
            },{
			id: "tree-container2",
                xtype: "container"
			
			}
			]
			},{
				id: "map2",
                xtype: "container",
                layout: "fit",
                region: "east",
                width: 500
			}
			]
        },
        
        // configuration of all tool plugins for this application
        tools: [{
            ptype: "gxp_layertree",
            outputConfig: {
                id: "tree",
                border: true,
                tbar: [] // we will add buttons to "tree.bbar" later
            },
            outputTarget: "tree-container"
        }, {
            ptype: "gxp_addlayers",
            actionTarget: "tree.tbar"
        }, {
            ptype: "gxp_removelayer",
            actionTarget: ["tree.tbar", "tree.contextMenu"]
        }, {
            ptype: "gxp_zoomtoextent",
            actionTarget: "map.tbar"
        }, {
            ptype: "gxp_zoom",
            actionTarget: "map.tbar"
        }, {
            ptype: "gxp_navigationhistory",
            actionTarget: "map.tbar"
        }],
        
        // layer sources
        defaultSourceType: "gxp_wmssource",
        sources: {
           osm: {
            ptype: "gxp_osmsource"
        }
        },
        
        // map and layers
        map: {
            id: "map-viewport", // id needed to reference map in items above
            title: "Map",
             projection: "EPSG:900913",
        units: "m",
        numZoomLevels: 21,
        maxResolution: 156543.03390625,
        maxExtent: [
            -20037508.34, -20037508.34,
            20037508.34, 20037508.34
        ],
        extent: [-13650159, 4534735, -13609227, 4554724],
        layers: [{
            source: "osm",
            name: "mapnik"
        }]
    },  
		listeners: {
        portalReady: function(){ setMap2() }
    }
});  
});  
  
var app2;
function setMap2(){
app2 = new gxp.Viewer({
    portalConfig: {id: "viewer2", xtype: "panel", split:true, width: "50%", renderTo: "map2", title: "kaart 2", collapsible: true, width:500,height:"100%",             collapseMode: "mini"},
    portalItems: ["map2"],
    mapItems: [
        {
            xtype: "gx_zoomslider",
            vertical: true,
            height: 100
        }
    ],
    sources: {
        osm: {
            ptype: "gxp_osmsource"
        }
    },
    map: {
        id: "map2",
        layou:"fit",
		width:"100%",
		height:800,
        projection: "EPSG:900913",
        units: "m",
        numZoomLevels: 21,
        maxResolution: 156543.03390625,
        maxExtent: [
            -20037508.34, -20037508.34,
            20037508.34, 20037508.34
        ],
        extent: [-13650159, 4534735, -13609227, 4554724],
        layers: [{
            source: "osm",
            name: "mapnik"
        }]
    },
    tools: [{          
            ptype: "gxp_layermanager",
            id: "lm2",
            outputConfig: {
                id: "tree2",
                title: "Layers2",
                tbar: []  // we will add buttons to "tree.bbar" later
            },
			outputTarget: "tree-container2"
        }]
    

});
}


var olmap1, olmap2;
function initialise(){
olmap1 = app1.mapPanel.map;
olmap2 = app2.mapPanel.map;
olmap1.events.on({"move":move1Listener});
olmap2.events.on({"moveend":move2Listener});
app1.tools.push({
            
            ptype: "gxp_layermanager",
            id: "lm1",
            outputConfig: {
                id: "tree",
                title: "Layers",
                tbar: []  // we will add buttons to "tree.bbar" later
            }
        });
		app1.doLayout();

}

function  move1Listener(e) {
 var center  = olmap1.getCenter();
 var zoom = olmap1.getZoom();
 //olmap2.events.un({"move":move2Listener});
 olmap2.setCenter(center);
 olmap2.zoomTo(zoom);
 //olmap2.events.on({"move":move2Listener});
}
function  move2Listener(e) {
 var center  = olmap2.getCenter();
 var zoom = olmap2.getZoom(); 
 olmap1.setCenter(center);
 olmap1.zoomTo(zoom);
}


  </script>
 
 </head>
 <body>
  <div id="main"></div>
 </body>
</html>